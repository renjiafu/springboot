<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rjf.mapper.StudentDao">

    <select id="getOne" resultType="Student">
        select  * from student where id=#{id}
    </select>

    <!--聚合对象-->
    <resultMap id="Base_Student" type="Student">
        <result column="id" property="id" jdbcType="NUMERIC"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="password" property="password" jdbcType="VARCHAR"/>
        <result column="clsid" property="clsId" jdbcType="NUMERIC"/>
        <association  property="cls" javaType="Cls">
            <result column="id" property="id" jdbcType="NUMERIC"/>
            <result column="clsname" property="clsName" jdbcType="VARCHAR"/>
        </association>
    </resultMap>

    <select id="getStudent" resultMap="Base_Student">
          select
            s.id,
            s.name,
            s.password,
            c.id,
            c.clsname
          from student s
          left join cls c on s.clsid=c.id
          where s.id=#{id}
    </select>
    <!--聚合列表-->
    <resultMap id="Base_Cls" type="Cls">
        <result column="id" property="id" jdbcType="NUMERIC"/>
        <result column="clsname" property="clsName" jdbcType="VARCHAR"/>
        <collection column="id" property="students" javaType="ArrayList" ofType="Student">
            <result column="id" property="id" jdbcType="NUMERIC"/>
            <result column="name" property="name" jdbcType="VARCHAR"/>
            <result column="password" property="password" jdbcType="VARCHAR"/>
            <result column="clsid" property="clsId" jdbcType="NUMERIC"/>
        </collection>
    </resultMap>

    <select id="getCls" resultMap="Base_Cls" >
        select
          c.id,
          c.clsname,
          s.id,
          s.name,
          s.password,
          s.clsid
        from cls c
        left join student s on c.id=s.clsid
        where c.id = #{id}
    </select>



  <!--  动态sql-->
    <select id="getStudentByStudent" resultType="Student">
        select *
        from student s
        <where>
            <if test="id !=null">
                and s.id=#{id}
            </if>
            <if test="name !=null">
                and s.name=#{name}
            </if>
            <if test="password !=null">
                and s.password=#{password}
            </if>
            <if test="clsId != null">
                and s.clsId=#{clsId}
            </if>

        </where>
    </select>

    <!--@Param传参-->
    <select id="getStudentByStudentParam" resultType="Student">
        select *
        from student s
        <where>
            <if test="student.id !=null">
                and s.id=#{student.id}
            </if>
            <if test="student.name">
                and s.name=#{student.name}
            </if>
        </where>
    </select>

    <!--@Param双对象传参-->
    <select id="getClsByTwoObjParam" resultMap="Base_Cls">
        select
          c.id,
          c.clsname,
          s.id,
          s.name,
          s.password,
          s.clsid
        from cls c
        left join student s on c.id=s.clsid
        <where>
            <if test="cls.id !=null">and c.id = #{cls.id} </if>
            <if test="student.id !=null">and s.id=#{student.id}</if>
        </where>
    </select>






</mapper>