<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rjf.mapper.StudentDao">

    <select id="getOne" resultType="Student">
        select  * from student where sid=#{sid}
    </select>

    <!--聚合对象-->
    <resultMap id="Base_Student" type="Student" autoMapping="true">
        <id column="sid" property="sid" jdbcType="NUMERIC"/>
        <association  property="cls" javaType="Cls" autoMapping="true">
           <id column="cid" property="cid" jdbcType="NUMERIC"/>
        </association>
    </resultMap>

    <select id="getStudent" resultMap="Base_Student">
          select
            s.sid,
            s.sname,
            s.password,
            s.clsid,
            c.cid,
            c.cname,
            c.monitor
          from student s
          left join cls c on s.clsid=c.cid
          where s.sid=#{sid}
    </select>

    <!--聚合列表-->
    <resultMap id="Base_Cls" type="Cls" autoMapping="true">
       <id column="cid" property="cid" jdbcType="NUMERIC"/>
        <collection column="id" property="students" javaType="ArrayList" ofType="Student" autoMapping="true">
            <id column="sid" property="sid" jdbcType="NUMERIC"/>
        </collection>
    </resultMap>

    <select id="getClsById" resultMap="Base_Cls" >
        select
          c.cid,
          c.cname,
          c.monitor,
          s.sid,
          s.sname,
          s.password,
          s.clsid,
          s.grade
        from cls c
        left join student s on c.cid=s.clsid
        where c.cid = #{cid}
    </select>



  <!--  动态sql-->
    <select id="getStudentByStudent" resultType="Student">
        select *
        from student s
        <where>
            <if test="sid !=null">
                and s.sid=#{sid}
            </if>
            <if test="sname !=null">
                and s.sname=#{sname}
            </if>
            <if test="password !=null">
                and s.password=#{password}
            </if>
            <if test="clsId != null">
                and s.clsId=#{clsId}
            </if>

        </where>
    </select>

    <!--@Param传参-->
    <select id="getStudentByStudentParam" resultType="Student">
        select *
        from student s
        <where>
            <if test="student.sid !=null">
                and s.sid=#{student.sid}
            </if>
            <if test="student.sname">
                and s.sname=#{student.sname}
            </if>
        </where>
    </select>

    <!--@Param双对象传参-->
    <select id="getClsByTwoObjParam" resultMap="Base_Cls">
        select
          c.cid,
          c.cname,
          s.sid,
          s.sname,
          s.password,
          s.grade,
          s.clsid
        from cls c
        left join student s on c.cid=s.clsid
        <where>
            <if test="cls.cid !=null">and c.cid = #{cls.cid} </if>
            <if test="student.sid !=null">and s.sid=#{student.sid}</if>
        </where>
    </select>

    <insert id="insertStudent" >
        insert into student
        (sname,password,clsid,grade)
        values(
        #{sname},
        #{password},
        #{clsId},
        #{grade}
        )
    </insert>


</mapper>